---
title: "scratch_work"
author: "Jackson Henningfield"
date: "4/22/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
# Plotting and exploring
library(tidyverse)  # For plotting and summarizing
library(GGally)     # For nice scatterplot matrix 
library(ggridges)   # For joy/ridge plots
library(corrplot)   # For basic correlation matrix plot
library(naniar)     # For exploring missing values
library(pdp)        # For partial dependence plots, MARS models
library(rpart.plot) # For plotting decision trees
library(vip)        # For importance plots
library(pROC)       # For ROC curves
library(plotROC)    # For plotting ROC curves

# Making things look nice
library(lubridate)  # For nice dates
library(knitr)      # For nice tables
library(scales)     # For nice labels on graphs
library(gridExtra)  # For arranging plots
library(broom)      # For nice model output
library(janitor)    # For nice names

# Data
library(ISLR)             # For data
library(moderndive)       # For data
library(rattle)           # Weather data
library(fivethirtyeight)  # Candy data

# Modeling
library(rsample)          # For splitting data
library(recipes)          # For keeping track of transformations
library(caret)            # For modeling
library(leaps)            # For variable selection
library(glmnet)           # For LASSO
library(earth)            # For MARS models
library(rpart)            # For decision trees
library(randomForest)     # For bagging and random forests

theme_set(theme_minimal())
```


```{r}
# Reading in the hotel booking demand data
#setwd("C:/Users/Lori/Desktop/STAT_253")
hotel_demand <- read.csv("hotel_bookings.csv")

# Change variable classes
hotel_demand <- hotel_demand %>%
  mutate(
    is_canceled = as.factor(is_canceled),
    is_repeated_guest = as.factor(is_repeated_guest),
  )
  
# Divide into training and testing
set.seed(253)
hotel_split <- initial_split(hotel_demand, prop = .7, 
                             strata = is_canceled)
hotel_train <- training(hotel_split)
hotel_test <- testing(hotel_split)

# Distribution of respone for the training data
table(hotel_train$is_canceled) %>% prop.table()

# Distribution of respone for testing data
table(hotel_test$is_canceled) %>% prop.table()
```

```{r,fig.width=10}
# First 6 rows of dataset
head(hotel_train)

# Exploratory graphs
hotel_train %>% 
  ggplot(aes(x=arrival_date_month))+
  geom_bar()


# Plot for cancellations
hotel_train %>% 
  ggplot(aes(x = is_canceled, fill = deposit_type)) +
  geom_bar(position = "fill") +
  labs(x = "Is Canceled?", y = "Proportion", fill = "Deposit Type")

hotel_train %>% 
  ggplot(aes(x = as.factor(is_canceled), fill = deposit_type)) +
  geom_bar(position = "fill") +
  labs(x = "Is Canceled?", y = "Proportion", fill = "Deposit Type")
```

