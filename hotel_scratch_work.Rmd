---
title: "scratch_work"
author: "Jackson Henningfield"
date: "4/22/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
# Plotting and exploring
library(tidyverse)  # For plotting and summarizing
library(GGally)     # For nice scatterplot matrix 
library(ggridges)   # For joy/ridge plots
library(corrplot)   # For basic correlation matrix plot
library(naniar)     # For exploring missing values
library(pdp)        # For partial dependence plots, MARS models
library(rpart.plot) # For plotting decision trees
library(vip)        # For importance plots
library(pROC)       # For ROC curves
library(plotROC)    # For plotting ROC curves

# Making things look nice
library(lubridate)  # For nice dates
library(knitr)      # For nice tables
library(scales)     # For nice labels on graphs
library(gridExtra)  # For arranging plots
library(broom)      # For nice model output
library(janitor)    # For nice names

# Modeling
library(rsample)          # For splitting data
library(recipes)          # For keeping track of transformations
library(caret)            # For modeling
library(leaps)            # For variable selection
library(glmnet)           # For LASSO
library(earth)            # For MARS models
library(rpart)            # For decision trees
library(randomForest)     # For bagging and random forests

# Color palettes
library(RColorBrewer)

# Data
library(ISLR)
library(moderndive)
library(rattle)
library(fivethirtyeight)

theme_set(theme_minimal())
```


```{r}
# Reading in the hotel booking demand data
#setwd("C:/Users/Lori/Desktop/STAT_253")
hotel_demand <- read.csv("hotel_bookings.csv")

# Change variable classes
hotel_numeric <- hotel_demand %>%
    select(-hotel,-arrival_date_month, -meal, -country, -market_segment, -distribution_channel, -reserved_room_type, -reserved_room_type, -assigned_room_type, -deposit_type, -agent, -company, -customer_type, -reservation_status_date, -reservation_status)

hotel_category <- hotel_demand %>% 
  select(-lead_time, -arrival_date_year, -arrival_date_week_number, -arrival_date_day_of_month, -stays_in_weekend_nights, -stays_in_week_nights, -adults, -children, -babies, -previous_bookings_not_canceled, -booking_changes, -days_in_waiting_list, -adr, -required_car_parking_spaces, -total_of_special_requests) %>% 
  mutate(is_canceled = as.factor(is_canceled)) %>% 
  mutate(is_repeated_guest = as.factor(is_repeated_guest))
  
  
# Divide into training and testing
set.seed(253)
hotel_split <- initial_split(hotel_demand, prop = .7, 
                             strata = is_canceled)
hotel_train <- training(hotel_split)
hotel_test <- testing(hotel_split)

# Distribution of respone for the training data
table(hotel_train$is_canceled) %>% prop.table()

# Distribution of respone for testing data
table(hotel_test$is_canceled) %>% prop.table()
```

```{r,fig.width=10}
# First 6 rows of dataset
head(hotel_train)

# Exploratory graphs
hotel_train %>% 
  ggplot(aes(x=arrival_date_month))+
  geom_bar()


# Plot for cancellations
hotel_train %>% 
  ggplot(aes(x = as.factor(is_canceled), fill = deposit_type)) +
  geom_bar(position = "fill") +
  labs(x = "Is Canceled?", y = "Proportion", fill = "Deposit Type")

hotel_train %>% 
  ggplot(aes(x = as.factor(is_canceled), fill = hotel)) +
  geom_bar(position = "fill") +
  labs(x = "Is Canceled?", y = "Proportion", fill = "Hotel Type")

hotel_train %>%
  ggplot(aes(x = as.factor(is_canceled), y = previous_cancellations)) +
  geom_boxplot() +
  labs(x = "Is Canceled?", y = "Precious Cancellations")
```

```{r, fig.width=12}
# making correlation plot for numeric subset
H<-cor(hotel_numeric)
head(round(H,2))

# numeric var. correlation plot
corrplot(H, method = "color")

```



